<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.nlog-project.org/schemas/NLog.xsd "
      autoReload="true"
      internalLogFile="internalNLogFile.txt"
      internalLogLevel="Trace">
    <!-- https://stackoverflow.com/questions/17269456/how-to-create-new-log-file-for-each-application-run -->
    <!-- https://stackoverflow.com/questions/73302202/nlog-create-unique-log-file-for-every-application-startup -->
    <variable name="LogDirectory" value="DtTelloDroneLogs/Log.${shortdate}/Session_${processinfo:StartTime:format=yyyyMMdd_HHmm:cached=true}/" />
    
    <!-- the targets to write to -->
    <targets async="true">
        <!-- write logs to file -->
        <target 
            name="Console" 
            xsi:type="Console"
            layout="${time}|${logger}|${message}" />
        <target 
            name="Debugger" 
            xsi:type="Debugger" 
            layout="${logger}::${message}"/>
        <target 
            name="ApplicationProcess"
            xsi:type="File" 
            fileName="${LogDirectory}/ApplicationInfoProcess.log" 
            layout="${time}|${logger}: ${message}" />
        <target
            name="TraceEverything"
            xsi:type="File"
            fileName="${LogDirectory}/ApplicationTraceProcess.log"
            layout="${time}|${logger}: ${message}"/>
        <target 
            name="FlightParameter" 
            xsi:type="File"
            fileName="${LogDirectory}/TelloRawData.log">
            <layout xsi:type="LayoutWithHeaderAndFooter">
                <header xsi:type="SimpleLayout" text="---------- Raw flight parameters log starting ---------&#xD;&#xA;"/>
                <layout xsi:type="SimpleLayout" text="${message}"/>
                <footer xsi:type="SimpleLayout" text="---------- End of log ---------&#xD;&#xA;"/>
            </layout>
        </target>
        <target
            name="AgentTick"
            xsi:type="File"
            fileName="${LogDirectory}/AgentTick.log"
            layout="${time} :: ${message}"/>
        <target
            name="KeyboardControl"
            xsi:type="File"
            fileName="${LogDirectory}/KeyboardControl.log"
            layout="${time};${message}"/>
    </targets>

    <!-- rules to map from logger name to target -->
    <rules>
        <!-- Trace Nachrichten -->
        <!-- Alle Nachrichten -->
        <logger 
            name="*" 
            minlevel="trace" 
            writeTo="TraceEverything"/>
        
        <!-- Filtere Rohdaten von der Drohne und dem darauf resultiernden Flugzustand.-->
        <logger
            name="DtTelloDrone.Model.Agent.TelloAgent"
            level="trace"
            writeTo="AgentTick,console"/>
        <logger 
            name="DtTelloDrone.RyzeSDK.CommunicationInferfaces.TelloStateServer" 
            level="trace" 
            writeTo="FlightParameter"/>
        <logger 
            name="DtTelloDrone.RemoteControl.Control.KeyboardControl" 
            level="trace" 
            writeTo="KeyboardControl"/>
        <logger 
            name="*" 
            minlevel="Info" 
            writeTo="ApplicationProcess"/>
        
        <!-- Filtere Start und Ende des Programms mit Abbau der Ressourcen-->
        <!-- Start und Ende des Drohnenflugs-->
        
        <!-- Warn nachrichten -->
        <!-- Fehlermeldungen von der Drohne -->
        
        <!-- Error Nachrichten -->
        <!-- Fehlermeldeungen vom System -->
        
    </rules>
</nlog>